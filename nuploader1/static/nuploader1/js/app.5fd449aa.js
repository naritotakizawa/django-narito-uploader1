(function(t){function e(e){for(var i,r,s=e[0],c=e[1],p=e[2],l=0,u=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&u.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);d&&d(e);while(u.length)u.shift()();return a.push.apply(a,p||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={app:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/uploader/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var p=0;p<s.length;p++)e(s[p]);var d=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var i=n("85ec"),o=n.n(i);o.a},"0c5f":function(t,e,n){"use strict";var i=n("e234"),o=n.n(i);o.a},"3a57":function(t,e,n){},"44f2":function(t,e,n){},4579:function(t,e,n){t.exports=n.p+"../static/nuploader1/img/add_file.fb603626.svg"},"46c7":function(t,e,n){t.exports=n.p+"../static/nuploader1/img/file.0b7031ed.svg"},5643:function(t,e,n){"use strict";var i=n("3a57"),o=n.n(i);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("ac1f"),n("3ca3"),n("1276"),n("498a"),n("ddb0");var i=n("3835"),o=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("header",{attrs:{id:"side"}},[i("router-link",{attrs:{to:{name:"list",params:{path:""}}}},[i("img",{attrs:{src:n("9b19"),id:"header-logo"}})])],1),i("main",{attrs:{id:"main"}},[i("router-view")],1)])},r=[],s={name:"app"},c=s,p=(n("034f"),n("2877")),d=Object(p["a"])(c,a,r,!1,null,null,null),l=d.exports,u=n("8c4f"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{attrs:{id:"composites"}},[n("div",{attrs:{id:"list"}},[t.current.parent?n("div",{key:t.current.parent.pk,staticClass:"parent composite-wrapper"},[n("Composite",{attrs:{data:t.current.parent},on:{click:t.moveBefore}})],1):t.current.pk?n("div",{key:-1,staticClass:"parent composite-wrapper"},[n("Composite",{attrs:{data:{name:"home",is_dir:"true"}},on:{click:t.moveTop}})],1):t._e(),t.current.pk?n("div",{key:t.current.pk,staticClass:"current composite-wrapper"},[n("Composite",{attrs:{data:t.current,editableIn:!0},on:{createDir:t.createDir,createFile:t.createFile}})],1):n("div",{key:-1,staticClass:"current composite-wrapper"},[n("Composite",{attrs:{data:{name:"home",is_dir:"true"},editableIn:!0},on:{createDir:t.createDir,createFile:t.createFile}})],1),t._l(t.current.composite_set,(function(e){return n("div",{key:e.pk,staticClass:"child composite-wrapper"},[n("Composite",{attrs:{data:e,editable:!0},on:{click:t.move,remove:t.remove,update:t.update,zip:t.zip}})],1)}))],2),n("div",{attrs:{id:"form"}},[n("composite-form",{key:t.selected.type+"-"+t.selected.data.pk,attrs:{selected:t.selected},on:{done:t.reload,close:t.close}})],1)])},f=[],h=(n("a15b"),n("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"composite"},[t.data.is_dir?i("img",{staticClass:"dir-icon",attrs:{src:n("b5d9")}}):i("img",{staticClass:"file-icon",attrs:{src:n("46c7")}}),t.data.pk?i("span",{staticClass:"id"},[t._v(t._s(t.data.pk))]):t._e(),i("a",{staticClass:"composite-link",on:{click:t.onclick}},[t._v(t._s(t.data.name))]),t.editableIn?[i("button",{staticClass:"img-button add-dir",attrs:{type:"button"},on:{click:t.createFile}},[i("img",{staticClass:"add-file-button-icon",attrs:{src:n("4579")}})]),i("button",{staticClass:"img-button add-file",attrs:{type:"button"},on:{click:t.createDir}},[i("img",{staticClass:"add-dir-button-icon",attrs:{src:n("6e7a")}})])]:t._e(),t.editable?[i("button",{staticClass:"img-button update",attrs:{type:"button"},on:{click:t.update}},[i("img",{staticClass:"update-button-icon",attrs:{src:n("8124")}})]),i("button",{staticClass:"img-button delete",attrs:{type:"button"},on:{click:t.remove}},[i("img",{staticClass:"delete-button-icon",attrs:{src:n("d739")}})]),t.data.zip_depth?i("button",{staticClass:"img-button zip",attrs:{type:"button"},on:{click:t.zip}},[i("img",{staticClass:"zip-button-icon",attrs:{src:n("d60a")}})]):t._e()]:t._e()],2)}),v=[],b={name:"composite",props:{data:{type:Object},editable:{type:Boolean,default:!1},editableIn:{type:Boolean,default:!1}},methods:{onclick:function(){this.$emit("click",this.data)},update:function(){this.$emit("update",this.data)},remove:function(){this.$emit("remove",this.data)},zip:function(){this.$emit("zip",this.data)},createFile:function(){this.$emit("createFile",this.data)},createDir:function(){this.$emit("createDir",this.data)}}},y=b,g=(n("e9b1"),Object(p["a"])(y,h,v,!1,null,"2eaa9bb4",null)),_=g.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"delete"===t.selected.type?n("form",{staticClass:"composite-form",on:{submit:function(e){return e.preventDefault(),t.remove(e)}}},[n("p",[t._v(t._s(t.selected.data.name)+"の削除")]),n("button",{attrs:{type:"submit"}},[t._v("削除")]),n("button",{staticClass:"button-link",on:{click:t.close}},[t._v("閉じる")])]):"new"===t.selected.type?n("form",{staticClass:"composite-form",on:{submit:function(e){return e.preventDefault(),t.add(e)}}},[n("p",[t._v("新規作成")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],attrs:{type:"text",placeholder:"名前"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),t.selected.data.is_dir?n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.zip_depth,expression:"form.zip_depth"}],attrs:{type:"number",placeholder:"ZIP階層"},domProps:{value:t.form.zip_depth},on:{input:function(e){e.target.composing||t.$set(t.form,"zip_depth",e.target.value)}}})]):n("div",[n("input",{ref:"upfile",attrs:{type:"file"}})]),n("button",{attrs:{type:"submit"}},[t._v("送信")]),n("button",{staticClass:"button-link",on:{click:t.close}},[t._v("閉じる")])]):"update"===t.selected.type?n("form",{staticClass:"composite-form",on:{submit:function(e){return e.preventDefault(),t.update(e)}}},[n("p",[t._v(t._s(t.selected.data.name)+"の更新")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],attrs:{type:"text",placeholder:"名前"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.parent,expression:"form.parent"}],attrs:{type:"text",placeholder:"親ディレクトリID"},domProps:{value:t.form.parent},on:{input:function(e){e.target.composing||t.$set(t.form,"parent",e.target.value)}}}),t.selected.data.is_dir?n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.zip_depth,expression:"form.zip_depth"}],attrs:{type:"number",placeholder:"ZIP階層"},domProps:{value:t.form.zip_depth},on:{input:function(e){e.target.composing||t.$set(t.form,"zip_depth",e.target.value)}}})]):n("div",[n("input",{ref:"upfile",attrs:{type:"file"}})]),n("button",{attrs:{type:"submit"}},[t._v("更新")]),n("button",{staticClass:"button-link",on:{click:t.close}},[t._v("閉じる")])]):t._e()},$=[],C={name:"composite-form",props:{selected:{type:Object}},data:function(){return{form:{name:"",zip_depth:0,parent:""}}},mounted:function(){"update"===this.selected.type&&(this.form.name=this.selected.data.name,this.form.zip_depth=this.selected.data.zip_depth,this.form.parent=this.selected.data.parent?this.selected.data.parent:"")},methods:{add:function(){var t=this,e=new FormData;if(e.append("name",this.form.name),e.append("is_dir",this.selected.data.is_dir),this.selected.data.is_dir)e.append("zip_depth",this.form.zip_depth);else{var n=this.$refs.upfile.files[0];n&&e.append("src",n)}this.selected.data.parent&&e.append("parent",this.selected.data.parent),this.$http(this.$endpoint,{credentials:"include",method:"POST",body:e,headers:{"X-CSRFToken":this.$csrfToken}}).then((function(e){return e.ok?e.json().then((function(){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #009"},t.form.name+"を追加しました"),duration:2e3}),t.$emit("done")})):e.json().then((function(e){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #900"},JSON.stringify(e)),duration:2e3})}))}))},update:function(){var t=this,e=new FormData;if(e.append("name",this.form.name),e.append("is_dir",this.selected.data.is_dir),this.selected.data.is_dir)e.append("zip_depth",this.form.zip_depth);else{var n=this.$refs.upfile.files[0];n&&e.append("src",n)}e.append("parent",this.form.parent),this.$http(this.$endpoint+this.selected.data.pk+"/",{credentials:"include",method:"PATCH",body:e,headers:{"X-CSRFToken":this.$csrfToken}}).then((function(e){return e.ok?e.json().then((function(){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #009"},t.form.name+"を更新しました"),duration:2e3}),t.$emit("done")})):e.json().then((function(e){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #900"},JSON.stringify(e)),duration:2e3})}))}))},remove:function(){var t=this;this.$http(this.$endpoint+this.selected.data.pk+"/",{credentials:"include",method:"DELETE",headers:{"X-CSRFToken":this.$csrfToken}}).then((function(e){if(!e.ok)return e.json().then((function(e){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #900"},JSON.stringify(e)),duration:2e3})}));t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #009"},t.selected.data.name+"を削除しました"),duration:2e3}),t.$emit("done")}))},close:function(){this.$emit("close")}}},w=C,x=(n("0c5f"),Object(p["a"])(w,k,$,!1,null,"048352b2",null)),P=x.exports,z={name:"composite-list",components:{Composite:_,CompositeForm:P},props:{path:{type:String}},data:function(){return{current:{},selected:{type:null,data:{}},nextPk:null}},watch:{$route:function(){this.nextPk?this.getCompositeListFromPk(this.nextPk):this.getCompositeListTop(),this.nextPk=null,this.selected={type:null,data:{}}}},created:function(){this.path?this.getCompositeListFromPath(this.path):this.getCompositeListTop()},methods:{getCompositeListTop:function(){var t=this;this.$http(this.$endpoint).then((function(t){return t.json()})).then((function(e){t.current={composite_set:e}}))},getCompositeListFromPath:function(t){var e=this;this.$http(this.$endpoint+"get_composite_from_path/"+t).then((function(t){return t.json()})).then((function(t){e.current=t}))},getCompositeListFromPk:function(t){var e=this;this.$http(this.$endpoint+t+"/").then((function(t){return t.json()})).then((function(t){e.current=t}))},getNextPath:function(t){var e=t.name;return t.is_dir&&(e+="/"),e},getBeforePath:function(){var t=[],e=!0,n=!1,i=void 0;try{for(var o,a=this.$route.path.split("/")[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var r=o.value;r&&t.push(r)}}catch(s){n=!0,i=s}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}return t.pop(),"/"+t.join("/")+"/"},moveBefore:function(){if(this.current.pk){this.current.parent?this.nextPk=this.current.parent.pk:this.nextPk=null;var t=this.getBeforePath();this.$router.push(t)}},move:function(t){var e=this.getNextPath(t);t.is_dir?(this.nextPk=t.pk,this.$router.push(e)):window.open(e,"_blank")},moveTop:function(){this.$router.push({name:"list",params:{path:""}})},update:function(t){this.selected.data=t,this.selected.type="update"},remove:function(t){this.selected.data=t,this.selected.type="delete"},createFile:function(t){this.selected.data={is_dir:!1,parent:t.pk?t.pk:"",type:"new"},this.selected.type="new"},createDir:function(t){this.selected.data={is_dir:!0,parent:t.pk?t.pk:"",type:"new"},this.selected.type="new"},reload:function(){this.selected.type=null,this.selected.data={},this.current.pk?this.getCompositeListFromPk(this.current.pk):this.getCompositeListTop()},zip:function(t){window.open("/uploader/zip/".concat(t.pk),"_blank")},close:function(){this.selected.data={},this.selected.type=null}}},j=z,O=(n("5643"),Object(p["a"])(j,m,f,!1,null,"76d025d0",null)),F=O.exports;o["default"].use(u["a"]);var T=[{path:"/home/:path(.*)",name:"list",component:F,props:!0}],D=new u["a"]({mode:"history",base:"/uploader/",routes:T}),S=D,E=n("5c96"),L=n.n(E),N=(n("c69f"),n("c3ff")),I=n.n(N);o["default"].use(L.a,{locale:I.a});var B=function(t){if(document.cookie&&""!==document.cookie){var e=!0,n=!1,o=void 0;try{for(var a,r=document.cookie.split(";")[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var s=a.value,c=s.trim().split("="),p=Object(i["a"])(c,2),d=p[0],l=p[1];if(d===t)return decodeURIComponent(l)}}catch(u){n=!0,o=u}finally{try{e||null==r.return||r.return()}finally{if(n)throw o}}}};o["default"].config.productionTip=!1,o["default"].prototype.$http=function(t,e){return fetch(t,e)},o["default"].prototype.$endpoint="/uploader/api/composites/",o["default"].prototype.$csrfToken=B("csrftoken"),new o["default"]({router:S,render:function(t){return t(l)}}).$mount("#app")},"6e7a":function(t,e,n){t.exports=n.p+"../static/nuploader1/img/add_dir.fe71e225.svg"},8124:function(t,e,n){t.exports=n.p+"../static/nuploader1/img/update.423f1f59.svg"},"85ec":function(t,e,n){},"9b19":function(t,e,n){t.exports=n.p+"../static/nuploader1/img/logo.b6b6b7e2.svg"},b5d9:function(t,e,n){t.exports=n.p+"../static/nuploader1/img/dir.892752bb.svg"},c69f:function(t,e,n){},d60a:function(t,e,n){t.exports=n.p+"../static/nuploader1/img/zip.a922043f.svg"},d739:function(t,e,n){t.exports=n.p+"../static/nuploader1/img/delete.b1dc3a0a.svg"},e234:function(t,e,n){},e9b1:function(t,e,n){"use strict";var i=n("44f2"),o=n.n(i);o.a}});
//# sourceMappingURL=app.5fd449aa.js.map